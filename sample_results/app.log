2021-01-23 14:57:31,485 Namespace(batch_size=8, data_setting='50', dropout_rate=0.1, embed_size=128, freeze_embed=True, label_attn_expansion=2, learning_rate=[0.001], log='INFO', max_len=2500, model='TransICD', num_attn_heads=8, num_epoch=[30, 35, 40], num_trans_layers=2, random_seed=271, trans_forward_expansion=4)

2021-01-23 14:57:31,869 train set length stats:
count    8066.000000
mean      921.500248
std       483.252560
min        54.000000
25%       578.000000
50%       840.000000
75%      1158.750000
max      5303.000000
Name: LENGTH, dtype: float64
2021-01-23 14:57:31,878 In train set, average code counts per discharge summary: 5.691296801388544
2021-01-23 14:57:31,894 Final number of labels/codes: 50
2021-01-23 14:57:31,925 train set true item count: 8064


2021-01-23 14:57:31,999 dev set length stats:
count    1573.000000
mean     1114.560712
std       471.017010
min       148.000000
25%       796.000000
50%      1040.000000
75%      1326.000000
max      3924.000000
Name: LENGTH, dtype: float64
2021-01-23 14:57:32,003 In dev set, average code counts per discharge summary: 5.881118881118881
2021-01-23 14:57:32,006 Final number of labels/codes: 50
2021-01-23 14:57:32,024 dev set true item count: 1568


2021-01-23 14:57:32,115 test set length stats:
count    1729.000000
mean     1132.429150
std       468.074764
min       127.000000
25%       810.000000
50%      1055.000000
75%      1358.000000
max      4001.000000
Name: LENGTH, dtype: float64
2021-01-23 14:57:32,117 In test set, average code counts per discharge summary: 6.039329091960671
2021-01-23 14:57:32,121 Final number of labels/codes: 50
2021-01-23 14:57:32,138 test set true item count: 1728


2021-01-23 14:57:32,213 Size of training vocabulary including PAD, UNK: 123918
2021-01-23 14:57:36,179 train dataset has on average 0.0018979848923695332 oov words per discharge summary
2021-01-23 14:57:37,105 dev dataset has on average 0.004350021037382748 oov words per discharge summary
2021-01-23 14:57:38,253 test dataset has on average 0.004234441238066067 oov words per discharge summary
2021-01-23 14:57:38,255 Taining labels are: ['038.9', '244.9', '250.00', '272.0', '272.4', '276.1', '276.2', '285.1', '285.9', '287.5', '305.1', '311', '33.24', '36.15', '37.22', '38.91', '38.93', '39.61', '39.95', '401.9', '403.90', '410.71', '412', '414.01', '424.0', '427.31', '428.0', '45.13', '486', '496', '507.0', '511.9', '518.81', '530.81', '584.9', '585.9', '599.0', '88.56', '88.72', '93.90', '96.04', '96.6', '96.71', '96.72', '99.04', '99.15', '995.92', 'V15.82', 'V45.81', 'V58.61']

2021-01-23 14:57:45,734 Total token count (including PAD, UNK) of full preprocessed discharge summaries: 123918
2021-01-23 14:57:51,657 Training with: HyperParams(learning_rate=0.001, num_epoch=30)
2021-01-23 14:57:51,657 Training Started...
2021-01-23 16:21:59,927 Training finished.

2021-01-23 16:22:55,199 train Accuracy: 0.09585813492063493
2021-01-23 16:22:55,199 train f1 score (micro): 0.7169363250993187
2021-01-23 16:22:55,199 train f1 score (macro): 0.6492463002384548
2021-01-23 16:22:55,199 train auc score (micro): 0.9589579578013996
2021-01-23 16:22:55,199 train auc score (macro): 0.9453680568475691
2021-01-23 16:22:55,199 train precision at ks [1, 5, 8, 10, 15]: [0.8973214285714286, 0.6702628968253969, 0.5381014384920635, 0.4697296626984127, 0.34915674603174607]

2021-01-23 16:23:06,010 dev Accuracy: 0.06696428571428571
2021-01-23 16:23:06,010 dev f1 score (micro): 0.6572769953051644
2021-01-23 16:23:06,010 dev f1 score (macro): 0.5766615951694309
2021-01-23 16:23:06,010 dev auc score (micro): 0.9284111710889889
2021-01-23 16:23:06,010 dev auc score (macro): 0.9023084604820107
2021-01-23 16:23:06,010 dev precision at ks [1, 5, 8, 10, 15]: [0.8329081632653061, 0.6209183673469387, 0.5039859693877551, 0.4426658163265306, 0.33588435374149667]

2021-01-23 16:23:28,430 test Accuracy: 0.05555555555555555
2021-01-23 16:23:28,430 test f1 score (micro): 0.6466637250576065
2021-01-23 16:23:28,430 test f1 score (macro): 0.5592676824479099
2021-01-23 16:23:28,430 test auc score (micro): 0.9238912895539683
2021-01-23 16:23:28,430 test auc score (macro): 0.8957257651229835
2021-01-23 16:23:28,430 test precision at ks [1, 5, 8, 10, 15]: [0.8339120370370371, 0.6197916666666666, 0.5076678240740741, 0.44930555555555557, 0.3425154320987654]

2021-01-23 16:23:54,142 Training with: HyperParams(learning_rate=0.001, num_epoch=35)
2021-01-23 16:23:54,143 Training Started...
2021-01-23 18:01:53,509 Training finished.

2021-01-23 18:02:48,982 train Accuracy: 0.1032986111111111
2021-01-23 18:02:48,982 train f1 score (micro): 0.7217613857087362
2021-01-23 18:02:48,982 train f1 score (macro): 0.6521449913532733
2021-01-23 18:02:48,982 train auc score (micro): 0.9610981582395686
2021-01-23 18:02:48,982 train auc score (macro): 0.9492574836773143
2021-01-23 18:02:48,982 train precision at ks [1, 5, 8, 10, 15]: [0.9031498015873016, 0.6770089285714286, 0.5421316964285714, 0.47216021825396826, 0.35076884920634926]

2021-01-23 18:02:59,850 dev Accuracy: 0.06377551020408163
2021-01-23 18:02:59,850 dev f1 score (micro): 0.6374305833858133
2021-01-23 18:02:59,850 dev f1 score (macro): 0.5542053253547433
2021-01-23 18:02:59,850 dev auc score (micro): 0.9219198542194549
2021-01-23 18:02:59,850 dev auc score (macro): 0.8941567033592992
2021-01-23 18:02:59,850 dev precision at ks [1, 5, 8, 10, 15]: [0.8227040816326531, 0.6099489795918367, 0.49473852040816324, 0.43654336734693877, 0.3336734693877551]

2021-01-23 18:03:23,133 test Accuracy: 0.050347222222222224
2021-01-23 18:03:23,133 test f1 score (micro): 0.6305970149253731
2021-01-23 18:03:23,133 test f1 score (macro): 0.5433152477926441
2021-01-23 18:03:23,133 test auc score (micro): 0.9190075668666973
2021-01-23 18:03:23,133 test auc score (macro): 0.8904649111764716
2021-01-23 18:03:23,133 test precision at ks [1, 5, 8, 10, 15]: [0.8136574074074074, 0.6035879629629629, 0.49877025462962965, 0.4416666666666667, 0.33977623456790124]

2021-01-23 18:03:44,828 Training with: HyperParams(learning_rate=0.001, num_epoch=40)
2021-01-23 18:03:44,829 Training Started...
2021-01-23 19:55:59,648 Training finished.

2021-01-23 19:56:54,884 train Accuracy: 0.10863095238095238
2021-01-23 19:56:54,884 train f1 score (micro): 0.7391832579928417
2021-01-23 19:56:54,885 train f1 score (macro): 0.6789788260980515
2021-01-23 19:56:54,885 train auc score (micro): 0.9643696592453569
2021-01-23 19:56:54,885 train auc score (macro): 0.9534357613269049
2021-01-23 19:56:54,885 train precision at ks [1, 5, 8, 10, 15]: [0.9076140873015873, 0.684796626984127, 0.5493241567460317, 0.4785590277777778, 0.35365410052910057]

2021-01-23 19:57:05,722 dev Accuracy: 0.056760204081632654
2021-01-23 19:57:05,722 dev f1 score (micro): 0.6393794355504209
2021-01-23 19:57:05,722 dev f1 score (macro): 0.5490195954022515
2021-01-23 19:57:05,722 dev auc score (micro): 0.9213048605575692
2021-01-23 19:57:05,722 dev auc score (macro): 0.8928475026756749
2021-01-23 19:57:05,722 dev precision at ks [1, 5, 8, 10, 15]: [0.8118622448979592, 0.6112244897959184, 0.49354272959183676, 0.4338010204081632, 0.33116496598639455]

2021-01-23 19:57:29,810 test Accuracy: 0.057291666666666664
2021-01-23 19:57:29,810 test f1 score (micro): 0.6338512172692513
2021-01-23 19:57:29,810 test f1 score (macro): 0.5505336024173749
2021-01-23 19:57:29,810 test auc score (micro): 0.9173825976733849
2021-01-23 19:57:29,810 test auc score (macro): 0.8884398782546215
2021-01-23 19:57:29,810 test precision at ks [1, 5, 8, 10, 15]: [0.8078703703703703, 0.6077546296296297, 0.49905960648148145, 0.4410300925925926, 0.3383487654320988]

